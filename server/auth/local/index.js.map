{"version":3,"sources":["../../../../server/auth/local/index.js"],"names":["router","Router","post","req","res","next","body","email","authenticate","err","user","info","error","status","json","message","token","_id","role","firstName"],"mappings":"AAAA;;;;;;AAEA;;;;AACA;;;;AACA;;;;AAEA,IAAIA,SAAS,kBAAQC,MAAR,EAAb;;AAEAD,OAAOE,IAAP,CAAY,GAAZ,EAAiB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACxC,MAAGF,IAAIG,IAAJ,CAASC,KAAZ,EAAmB;AACjB,uBAASC,YAAT,CAAsB,aAAtB,EAAqC,UAASC,GAAT,EAAcC,IAAd,EAAoBC,IAApB,EAA0B;AAC7D,UAAIC,QAAQH,OAAOE,IAAnB;AACA,UAAIC,KAAJ,EAAW;AACT,eAAOR,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,KAArB,CAAP;AACD;AACD,UAAI,CAACF,IAAL,EAAW;AACT,eAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,yCAAV,EAArB,CAAP;AACD;;AAED,UAAIC,QAAQ,qBAAUN,KAAKO,GAAf,EAAoBP,KAAKQ,IAAzB,CAAZ;AACA,aAAOd,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEE,YAAF,EAArB,CAAP;AACD,KAXD,EAWGb,GAXH,EAWQC,GAXR,EAWaC,IAXb;AAYD,GAbD,MAaO,IAAGF,IAAIG,IAAJ,CAASa,SAAZ,EAAuB;AAC5B,uBAASX,YAAT,CAAsB,OAAtB,EAA+B,UAASC,GAAT,EAAcC,IAAd,EAAoBC,IAApB,EAA0B;AACvD,UAAIC,QAAQH,OAAOE,IAAnB;AACA,UAAIC,KAAJ,EAAW;AACT,eAAOR,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,KAArB,CAAP;AACD;AACD,UAAI,CAACF,IAAL,EAAW;AACT,eAAON,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,yCAAV,EAArB,CAAP;AACD;;AAED,UAAIC,QAAQ,qBAAUN,KAAKO,GAAf,EAAoBP,KAAKQ,IAAzB,CAAZ;AACAd,UAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEE,YAAF,EAArB;AACD,KAXD,EAWGb,GAXH,EAWQC,GAXR,EAWaC,IAXb;AAYD,GAbM,MAaA;AACL,WAAOD,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAArB,CAAP;AACD;AAEF,CA/BD;;kBAiCed,M","file":"index.js","sourcesContent":["'use strict';\n\nimport express from 'express';\nimport passport from 'passport';\nimport {signToken} from '../auth.service';\n\nvar router = express.Router();\n\nrouter.post('/', function(req, res, next) {\n  if(req.body.email) {\n    passport.authenticate('local-email', function(err, user, info) {\n      var error = err || info;\n      if (error) {\n        return res.status(401).json(error);\n      }\n      if (!user) {\n        return res.status(404).json({message: 'Something went wrong, please try again.'});\n      }\n\n      var token = signToken(user._id, user.role);\n      return res.status(200).json({ token });\n    })(req, res, next)\n  } else if(req.body.firstName) {\n    passport.authenticate('local', function(err, user, info) {\n      var error = err || info;\n      if (error) {\n        return res.status(401).json(error);\n      }\n      if (!user) {\n        return res.status(404).json({message: 'Something went wrong, please try again.'});\n      }\n\n      var token = signToken(user._id, user.role);\n      res.status(200).json({ token });\n    })(req, res, next)\n  } else {\n    return res.status(401).json({});\n  }\n\n});\n\nexport default router;\n"]}