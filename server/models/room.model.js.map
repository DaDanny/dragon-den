{"version":3,"sources":["../../../server/models/room.model.js"],"names":["mongoose","require","extend","dateUtil","BaseSchema","schema","Schema","RoomSchema","width","String","length","amountOfPlants","Number","amountOfLights","roomType","tasks","type","Types","ObjectId","ref","startDate","Date","set","standardizeDate","flippedDate","default","endDate","lightsOn","lightsOff","timelines","amountOfReservoirs","amountOfTables","amountOfFlats","amountOfMachines","TBDTasks","Array","mainColor","fullCycles","generatedVegTasks","generatedFlowerTasks","taskGenerationEvents","pre","buildRoom","next","populate","dateHooks","map","date","isModified","model"],"mappings":";;;;;;AAKA;;;;;;AALA;;;AAGA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,SAASD,QAAQ,wBAAR,CAAb;;AAEA,IAAIE,WAAWF,QAAQ,4BAAR,CAAf;AACA,IAAIG,aAAa,eAAUC,MAA3B;AACA,IAAIC,SAASN,SAASM,MAAtB;;AAEA,IAAIC,aAAaH,WAAWF,MAAX,CAAkB;AACjCM,SAAOC,MAD0B;AAEjCC,UAAQD,MAFyB;AAGjCE,kBAAgBC,MAHiB;AAIjCC,kBAAgBD,MAJiB;AAKjCE,YAAUL,MALuB;AAMjCM,SAAQ,CAAC,EAACC,MAAMV,OAAOW,KAAP,CAAaC,QAApB,EAA8BC,KAAK,MAAnC,EAAD,CANyB;AAOjCC,aAAY,EAACJ,MAAOK,IAAR,EAAcC,KAAKnB,SAASoB,eAA5B,EAPqB;AAQjCC,eAAc,EAACR,MAAOK,IAAR,EAAcI,SAAS,IAAvB,EARmB;AASjCC,WAAU,EAACV,MAAOK,IAAR,EAAcC,KAAKnB,SAASoB,eAA5B,EATuB;AAUjCI,YAAWN,IAVsB;AAWjCO,aAAYP,IAXqB;AAYjCQ,aAAY,CAAC,EAACb,MAAMV,OAAOW,KAAP,CAAaC,QAApB,EAA8BC,KAAK,cAAnC,EAAD,CAZqB;AAajCW,sBAAqBlB,MAbY;AAcjCmB,kBAAiBnB,MAdgB;AAejCoB,iBAAgBpB,MAfiB;AAgBjCqB,oBAAmBrB,MAhBc;AAiBjCsB,YAAWC,KAjBsB;AAkBjCC,aAAY3B,MAlBqB;AAmBjC4B,cAAaF,KAnBoB;AAoBjCG,qBAAoB,EAACtB,MAAOK,IAAR,EAAcC,KAAKnB,SAASoB,eAA5B,EApBa;AAqBjCgB,wBAAuB,EAACvB,MAAOK,IAAR,EAAcC,KAAKnB,SAASoB,eAA5B,EArBU;AAsBjCiB,wBAAuB,EAACxB,MAAOmB,KAAR,EAAeV,SAAU,EAAzB;;AAtBU,CAAlB,CAAjB;;AA0BAlB,WAAWkC,GAAX,CAAe,MAAf,EAAsBC,SAAtB;;AAEA,SAASA,SAAT,CAAmBC,IAAnB,EAAyB;AACvB,OAAKC,QAAL,CAAc,OAAd;AACA,OAAKA,QAAL,CAAc,WAAd;AACAD;AACD;;AAED,IAAIE,YAAY,CAAC,WAAD,EAAc,SAAd,EAAyB,aAAzB,CAAhB;;AAEAtC,WAAWkC,GAAX,CAAe,MAAf,EAAuB,UAASE,IAAT,EAAe;AAAA;;AAEpCE,YAAUC,GAAV,CAAc,gBAAQ;AACpB,QAAG,MAAKC,IAAL,KAAc,MAAKC,UAAL,CAAgBD,IAAhB,CAAjB,EAAwC;AACtC,YAAKA,IAAL,IAAa5C,SAASoB,eAAT,CAAyB,MAAKwB,IAAL,CAAzB,CAAb;AACD;AACF,GAJD;;AAMA;AACA;AACA;AACAJ;AACD,CAZD;;kBAce3C,SAASiD,KAAT,CAAe,MAAf,EAAuB1C,UAAvB,C","file":"room.model.js","sourcesContent":["/**\n * Created by Danny on 7/15/16.\n */\nvar mongoose = require('mongoose');\nvar extend = require('mongoose-schema-extend');\nimport BaseModel from './base.model';\nvar dateUtil = require('./../components/Date.Utils');\nvar BaseSchema = BaseModel.schema;\nvar Schema = mongoose.Schema;\n\nvar RoomSchema = BaseSchema.extend({\n  width: String,\n  length: String,\n  amountOfPlants: Number,\n  amountOfLights: Number,\n  roomType: String,\n  tasks : [{type: Schema.Types.ObjectId, ref: 'Task'}],\n  startDate : {type : Date, set: dateUtil.standardizeDate},\n  flippedDate : {type : Date, default: null},\n  endDate : {type : Date, set: dateUtil.standardizeDate},\n  lightsOn : Date,\n  lightsOff : Date,\n  timelines : [{type: Schema.Types.ObjectId, ref: 'RoomTimeline'}],\n  amountOfReservoirs : Number,\n  amountOfTables : Number,\n  amountOfFlats : Number,\n  amountOfMachines : Number,\n  TBDTasks : Array,\n  mainColor : String,\n  fullCycles : Array,\n  generatedVegTasks : {type : Date, set: dateUtil.standardizeDate},\n  generatedFlowerTasks : {type : Date, set: dateUtil.standardizeDate},\n  taskGenerationEvents : {type : Array, default : []}\n\n})\n\nRoomSchema.pre('find',buildRoom)\n\nfunction buildRoom(next) {\n  this.populate('tasks')\n  this.populate('timelines');\n  next();\n}\n\nvar dateHooks = ['startDate', 'endDate', 'flippedDate'];\n\nRoomSchema.pre('save', function(next) {\n\n  dateHooks.map(date => {\n    if(this[date] && this.isModified(date)) {\n      this[date] = dateUtil.standardizeDate(this[date]);\n    }\n  })\n\n  //if(this.startDate) this.startDate = dateUtil.standardizeDate(this.startDate);\n  //if(this.flippedDate) this.flippedDate = dateUtil.standardizeDate(this.flippedDate);\n  //if(this.endDate) this.endDate = dateUtil.standardizeDate(this.endDate);\n  next();\n})\n\nexport default mongoose.model('Room', RoomSchema);\n"]}